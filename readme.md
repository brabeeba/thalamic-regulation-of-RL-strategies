# Code for "Thalamic regulation of reinforcement learning strategies across prefrontal-striatal networks"
DOI: TODO

## Installation
The code has been tested on python 3.12.3. It is highly recommended to use virtual environment to install the package. 
> virtualenv env

To install all the dependency, we recommend to use pip to install. This process will take about 5 minutes.
>pip install -r requirements.txt

## Data Availability
To run the code, please download the corresponding dataset deposited at Mendeley. The DOI is TODO

## Inspect the dataset
Neural activity dataset is stored via pickle.dump. The name of the dataset for experiment is experiment1_data. To load the dataset, simply use load_dict from util.py.
>from util import load_dict
>
>data = load_dict("experiment1_data")
The above code loads the data from experiment 1.

The behavior dataset is stored in action.csv, stimuli.csv, reward.csv and block.csv. 

## File description
config.py is used to setup the parameter of the experiments.

train.py is used to run the experiment and generate data. Following code is an example to run the experiment.
> python train.py --experiment_num 1

plot.py is used to analyze the data and generate the figures. Following code is an example to analyze the experiment.
>python plot.py 

connectivity.py is used to analyze the data and generate the causal connectivity figures. Following code is an example to analyze the experiment.
>python connectivity.py 

model.py specifies he model in the experiments. 

task.py specifies the task.

inference.py specifies the hyperparameters of the models in each experiment. 

experiment.py is a helper script to conduct and log the experiments. 

posterior.py is a helper script to split blocks into model free and model based.

tensor_logger.py, util.py are utility scripts that helps running the exepriments.

## Reproduction instruction
One can generate the data in experiment 1 by running
>python train.py

This can take upto hours. If one would like, they can download the dataset generated by us deposited at Mendeley. The DOI is TODO

One can analyze the data of experiment and generate the corresponding figures by running
>python plot.py 
>python connectivity.py